# âš™ï¸ Configuration Files - Explained

> **Purpose:** This document explains all the configuration files in the project root  
> **Audience:** Developers who want to understand how the project is configured

---

## ğŸ“‹ Table of Contents

1. [.env](#1-env---environment-variables)
2. [.env.example](#2-envexample---template-for-env)
3. [.gitignore](#3-gitignore---git-exclusions)
4. [.dockerignore](#4-dockerignore---docker-exclusions)
5. [Dockerfile](#5-dockerfile---docker-container-setup)
6. [run.bat](#6-runbat---windows-launcher)
7. [run.sh](#7-runsh---linuxmac-launcher)
8. [vercel.json](#8-verceljson---vercel-deployment)

---

## 1. `.env` - Environment Variables

**Location:** Project root (NOT committed to Git)

```dotenv
GEMINI_API_KEY=your_actual_api_key_here
```

### What It Does

| Line | Purpose |
|------|---------|
| `GEMINI_API_KEY=...` | Your Google Gemini API key for AI features |

### Key Points

- âš ï¸ **NEVER commit this file** - contains secrets
- ğŸ“ Listed in `.gitignore` so it won't be pushed
- ğŸ”‘ Required for the app to work
- ğŸ”„ Loaded by Python's `python-dotenv` library

### How It's Used

```python
# In src/llm_client.py
from dotenv import load_dotenv
load_dotenv()  # Loads .env file

api_key = os.getenv("GEMINI_API_KEY")  # Gets the key
```

---

## 2. `.env.example` - Template for .env

**Location:** Project root (committed to Git)

```dotenv
GEMINI_API_KEY=your_api_key_here
# Get your free API key from: https://makersuite.google.com/app/apikey
```

### What It Does

| Line | Purpose |
|------|---------|
| `GEMINI_API_KEY=your_api_key_here` | Placeholder showing what key is needed |
| `# Get your free...` | Comment with instructions to get the key |

### Key Points

- âœ… **Safe to commit** - no real secrets
- ğŸ“ Template for new developers
- ğŸ“‹ Copy this to `.env` and fill in real values

### Setup Instructions

```bash
# Step 1: Copy the template
cp .env.example .env

# Step 2: Edit .env and add your real API key
# Windows: notepad .env
# Mac/Linux: nano .env
```

---

## 3. `.gitignore` - Git Exclusions

**Location:** Project root

```ignore
.env
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
*.egg-info/
.installed.cfg
*.egg
.venv
venv/
ENV/
.DS_Store
data/processed_emails.db
data/embeddings/
.streamlit/secrets.toml
.vscode/
.idea/
*.swp
*.swo
Thumbs.db
```

### What It Does

Tells Git which files/folders to **ignore** (not track).

### Categories Explained

| Pattern | What It Ignores | Why |
|---------|-----------------|-----|
| `.env` | Environment variables | Contains secrets |
| `__pycache__/` | Python bytecode cache | Auto-generated |
| `*.py[cod]` | `.pyc`, `.pyo`, `.pyd` files | Compiled Python |
| `*.so` | Shared object files | Compiled binaries |
| `.venv`, `venv/`, `ENV/` | Virtual environments | Local dependency installs |
| `build/`, `dist/` | Build outputs | Generated files |
| `*.egg-info/`, `*.egg` | Python package info | Generated by pip |
| `.DS_Store` | macOS folder metadata | OS-specific |
| `Thumbs.db` | Windows thumbnail cache | OS-specific |
| `.vscode/`, `.idea/` | IDE settings | Personal preferences |
| `data/processed_emails.db` | SQLite database | Runtime data |
| `data/embeddings/` | Vector embeddings | Runtime data |
| `*.swp`, `*.swo` | Vim swap files | Editor temp files |

### Pattern Syntax

| Pattern | Meaning |
|---------|---------|
| `*` | Match any characters |
| `**` | Match directories recursively |
| `/` at end | Match only directories |
| `!` at start | Negate (don't ignore) |
| `#` | Comment |

---

## 4. `.dockerignore` - Docker Exclusions

**Location:** Project root

```plaintext
__pycache__/
*.py[cod]
*$py.class
*.so
.env
.venv
venv/
ENV/
.git/
.gitignore
.DS_Store
*.md
!README.md
.streamlit/secrets.toml
data/processed_emails.db
data/embeddings/
test_*.py
*.log
```

### What It Does

Tells Docker which files to **exclude** when building the image.

### Why It's Important

- ğŸš€ **Smaller images** - don't copy unnecessary files
- ğŸ”’ **Security** - don't include secrets in image
- âš¡ **Faster builds** - less to copy

### Special Patterns

| Pattern | Effect |
|---------|--------|
| `*.md` | Ignore all markdown files |
| `!README.md` | EXCEPT README.md (keep it) |
| `test_*.py` | Ignore test files |
| `.git/` | Ignore Git history (saves space) |

### Comparison with .gitignore

| File | Purpose |
|------|---------|
| `.gitignore` | What Git should not track |
| `.dockerignore` | What Docker should not copy into image |

---

## 5. `Dockerfile` - Docker Container Setup

**Location:** Project root

```dockerfile
# Use Python 3.11 slim image
FROM python:3.11-slim

# Set working directory
WORKDIR /app

# Copy requirements first for better caching
COPY requirements.txt .

# Install dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy application files
COPY . .

# Expose Streamlit port
EXPOSE 8501

# Health check
HEALTHCHECK CMD curl --fail http://localhost:8501/_stcore/health || exit 1

# Set environment variables
ENV STREAMLIT_SERVER_PORT=8501
ENV STREAMLIT_SERVER_ADDRESS=0.0.0.0

# Run the application
CMD ["streamlit", "run", "app.py", "--server.address", "0.0.0.0"]
```

### Line-by-Line Explanation

```dockerfile
FROM python:3.11-slim
```
> **Base image:** Start with Python 3.11 on a minimal Linux (slim = smaller size)

---

```dockerfile
WORKDIR /app
```
> **Working directory:** All following commands run in `/app` folder

---

```dockerfile
COPY requirements.txt .
```
> **Copy dependencies list first:** This is a Docker caching trick!
> If requirements.txt hasn't changed, Docker reuses the cached layer.

---

```dockerfile
RUN pip install --no-cache-dir -r requirements.txt
```
> **Install Python packages:**
> - `--no-cache-dir` = don't keep pip cache (smaller image)

---

```dockerfile
COPY . .
```
> **Copy app code:** Copies everything (except .dockerignore entries)

---

```dockerfile
EXPOSE 8501
```
> **Document the port:** Tells Docker/users which port the app uses
> (Note: This is for Streamlit; Flask uses 5000)

---

```dockerfile
HEALTHCHECK CMD curl --fail http://localhost:8501/_stcore/health || exit 1
```
> **Health check:** Docker periodically checks if the app is running
> - If curl fails â†’ container is unhealthy

---

```dockerfile
ENV STREAMLIT_SERVER_PORT=8501
ENV STREAMLIT_SERVER_ADDRESS=0.0.0.0
```
> **Environment variables:**
> - `0.0.0.0` = listen on all network interfaces (needed in Docker)

---

```dockerfile
CMD ["streamlit", "run", "app.py", "--server.address", "0.0.0.0"]
```
> **Startup command:** What runs when container starts
> Note: This is for Streamlit version; Flask would use `python app.py`

### Docker Commands

```bash
# Build the image
docker build -t email-agent .

# Run the container
docker run -p 5000:5000 --env-file .env email-agent

# Run with Flask (override CMD)
docker run -p 5000:5000 --env-file .env email-agent python app.py
```

---

## 6. `run.bat` - Windows Launcher

**Location:** Project root

```bat
@echo off
REM Quick start script for Windows

echo ================================
echo Email Productivity Agent
echo ================================
echo.

REM Check if Python is installed
python --version >nul 2>&1
if errorlevel 1 (
    echo Error: Python is not installed or not in PATH
    echo Please install Python 3.8+ from https://www.python.org/
    pause
    exit /b 1
)

echo Checking dependencies...
pip show Flask >nul 2>&1
if errorlevel 1 (
    echo Installing dependencies...
    pip install -r requirements.txt
)

echo.
echo Starting application...
echo.
echo The app will open in your browser at http://localhost:5000
echo Press Ctrl+C to stop the server
echo.

python app.py
```

### Line-by-Line Explanation

```bat
@echo off
```
> **Suppress command echoing:** Don't show each command as it runs

---

```bat
REM Quick start script for Windows
```
> **Comment:** `REM` is how you write comments in batch files

---

```bat
python --version >nul 2>&1
```
> **Check Python exists:**
> - `>nul` = hide standard output
> - `2>&1` = also hide errors

---

```bat
if errorlevel 1 (
    ...
    exit /b 1
)
```
> **Error handling:** If previous command failed (errorlevel â‰¥ 1), show error and exit

---

```bat
pip show Flask >nul 2>&1
```
> **Check if Flask is installed:** `pip show` returns error if not installed

---

```bat
pip install -r requirements.txt
```
> **Install dependencies:** Only runs if Flask wasn't found

---

```bat
python app.py
```
> **Start the app!**

### How to Use

```cmd
# Double-click run.bat in Explorer
# OR run from command prompt:
run.bat
```

---

## 7. `run.sh` - Linux/Mac Launcher

**Location:** Project root

```bash
#!/bin/bash
# Quick start script for Linux/Mac

echo "================================"
echo "Email Productivity Agent"
echo "================================"
echo

# Check if Python is installed
if ! command -v python3 &> /dev/null; then
    echo "Error: Python 3 is not installed"
    echo "Please install Python 3.8+ from https://www.python.org/"
    exit 1
fi

echo "Checking dependencies..."
if ! python3 -c "import flask" &> /dev/null; then
    echo "Installing dependencies..."
    pip3 install -r requirements.txt
fi

echo
echo "Starting application..."
echo
echo "The app will open in your browser at http://localhost:5000"
echo "Press Ctrl+C to stop the server"
echo

python3 app.py
```

### Line-by-Line Explanation

```bash
#!/bin/bash
```
> **Shebang:** Tells the system to use Bash to run this script

---

```bash
if ! command -v python3 &> /dev/null; then
```
> **Check Python exists:**
> - `command -v` = check if command exists
> - `!` = negate (if NOT found)
> - `&> /dev/null` = hide all output

---

```bash
if ! python3 -c "import flask" &> /dev/null; then
```
> **Check Flask is installed:**
> - `python3 -c` = run Python code from command line
> - If import fails â†’ error â†’ install dependencies

---

```bash
pip3 install -r requirements.txt
```
> **Install dependencies:** Uses `pip3` for Python 3

---

```bash
python3 app.py
```
> **Start the app:** Uses `python3` explicitly

### How to Use

```bash
# Make executable (first time only)
chmod +x run.sh

# Run it
./run.sh
```

### Differences from run.bat

| Aspect | run.bat (Windows) | run.sh (Linux/Mac) |
|--------|-------------------|---------------------|
| Shell | Command Prompt | Bash |
| Python command | `python` | `python3` |
| Pip command | `pip` | `pip3` |
| Comments | `REM` | `#` |
| Check command | `>nul 2>&1` | `&> /dev/null` |
| Make executable | N/A | `chmod +x` needed |

---

## 8. `vercel.json` - Vercel Deployment

**Location:** Project root

```json
{
  "version": 2,
  "builds": [
    {
      "src": "app.py",
      "use": "@vercel/python"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "app.py"
    }
  ]
}
```

### What It Does

Configures how **Vercel** (cloud platform) deploys the app.

### Line-by-Line Explanation

```json
"version": 2
```
> **Config version:** Use Vercel's v2 build system

---

```json
"builds": [
  {
    "src": "app.py",
    "use": "@vercel/python"
  }
]
```
> **Build configuration:**
> - `src` = entry point file
> - `use` = Vercel's Python runtime builder

---

```json
"routes": [
  {
    "src": "/(.*)",
    "dest": "app.py"
  }
]
```
> **Routing:**
> - `src: "/(.*)"` = match ALL incoming URLs (regex)
> - `dest` = send them all to app.py
> 
> This is needed because Flask handles its own routing internally.

### How Vercel Deployment Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Vercel Deployment                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. Push to GitHub                                              â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  2. Vercel detects push                                         â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  3. Reads vercel.json                                           â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  4. Uses @vercel/python builder                                 â”‚
â”‚     - Installs requirements.txt                                 â”‚
â”‚     - Sets up serverless function                               â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  5. Routes all requests to app.py                               â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  6. App is live! ğŸ‰                                             â”‚
â”‚     https://your-app.vercel.app                                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Vercel Environment Variables

Since `.env` isn't deployed, set variables in Vercel dashboard:
1. Go to Project Settings â†’ Environment Variables
2. Add `GEMINI_API_KEY` with your key
3. Redeploy

---

## ğŸ“Š Summary Table

| File | Purpose | Committed to Git? |
|------|---------|-------------------|
| `.env` | Real API keys | âŒ No (secret!) |
| `.env.example` | Template for .env | âœ… Yes |
| `.gitignore` | Git exclusions | âœ… Yes |
| `.dockerignore` | Docker exclusions | âœ… Yes |
| `Dockerfile` | Container setup | âœ… Yes |
| `run.bat` | Windows launcher | âœ… Yes |
| `run.sh` | Linux/Mac launcher | âœ… Yes |
| `vercel.json` | Cloud deployment | âœ… Yes |

---

## ğŸš€ Quick Start by Platform

### Local (Windows)
```cmd
# 1. Create .env with your API key
copy .env.example .env
notepad .env

# 2. Run
run.bat
```

### Local (Mac/Linux)
```bash
# 1. Create .env with your API key
cp .env.example .env
nano .env

# 2. Make script executable & run
chmod +x run.sh
./run.sh
```

### Docker
```bash
# 1. Build
docker build -t email-agent .

# 2. Run (with .env file)
docker run -p 5000:5000 --env-file .env email-agent python app.py
```

### Vercel
```bash
# 1. Push to GitHub
git push origin main

# 2. Connect repo in Vercel dashboard
# 3. Add GEMINI_API_KEY in Environment Variables
# 4. Deploy!
```

---

*Last Updated: December 18, 2025*
